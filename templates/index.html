<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BossHub Ultimate Guardian (TH)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        body { background-color: #000; color: #f0f0f0; font-family: 'Sarabun', sans-serif; }
        
        /* UI Style */
        .card { background-color: #111; border: 1px solid #333; margin-bottom: 20px; box-shadow: 0 0 10px rgba(0, 255, 65, 0.1); }
        .card-header { font-weight: bold; text-transform: uppercase; letter-spacing: 1px; border-bottom: 1px solid #333; }
        .text-muted { color: #888 !important; }
        
        /* Neon Effect */
        .text-neon { color: #00ff41; text-shadow: 0 0 5px rgba(0, 255, 65, 0.5); }
        .stat-val { font-size: 2rem; font-weight: bold; color: #00ff41; }
        
        /* Tabs */
        .nav-tabs { border-bottom: 1px solid #333; }
        .nav-tabs .nav-link { color: #666; border: none; }
        .nav-tabs .nav-link.active { background-color: transparent; color: #00ff41; border-bottom: 3px solid #00ff41; font-weight: bold; }
        
        /* Tables & Pre */
        .table-dark { --bs-table-bg: #111; color: #ddd; border-color: #333; }
        pre { background: #0a0a0a; color: #0f0; padding: 15px; border: 1px solid #333; border-radius: 4px; }
        
        /* Code Snippet Box */
        .code-snippet { 
            font-family: 'Courier New', monospace; font-size: 0.85em; 
            background-color: #1a1a1a; padding: 8px; 
            border-left: 3px solid #dc3545; color: #ff9999; 
            display: block; margin-top: 5px; word-break: break-all;
        }
    </style>
</head>
<body>

<nav class="navbar navbar-dark bg-black border-bottom border-success mb-3">
    <div class="container">
        <span class="navbar-brand text-neon"><i class="bi bi-shield-check"></i> BossHub Ultimate Guardian</span>
        <span class="text-white small">Status: Active</span>
    </div>
</nav>

<div class="container">
    <ul class="nav nav-tabs mb-4" id="myTab" role="tablist">
        <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#dashboard">DASHBOARD</button></li>
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#threats">THREAT HUNTER</button></li>
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tools">TOOLS</button></li>
    </ul>

    <div class="tab-content" id="myTabContent">
        
        <div class="tab-pane fade show active" id="dashboard">
            <div class="row text-center mb-3">
                <div class="col-6 col-md-3"><div class="card p-3"><span class="text-muted">CPU</span><div class="stat-val" id="cpuVal">-</div></div></div>
                <div class="col-6 col-md-3"><div class="card p-3"><span class="text-muted">RAM</span><div class="stat-val" id="ramVal">-</div></div></div>
                <div class="col-6 col-md-3"><div class="card p-3"><span class="text-muted">UPTIME</span><div id="uptimeVal" class="h5 text-white">-</div></div></div>
                <div class="col-6 col-md-3"><div class="card p-3"><span class="text-muted">OS</span><div id="osVal" class="h5 text-white">-</div></div></div>
            </div>
            <div class="row">
                <div class="col-md-6"><div class="card h-100"><div class="card-header bg-dark text-success">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏î‡∏¥‡∏™‡∏Å‡πå & ‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢</div><div class="card-body" id="diskNetBody">Loading...</div></div></div>
                <div class="col-md-6"><div class="card h-100"><div class="card-header bg-dark text-danger">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ & Firewall</div><div class="card-body"><h6>Firewall Status:</h6><pre id="firewallOut" class="p-2 mb-2">-</pre><h6>Last Logins:</h6><ul class="list-group list-group-flush small" id="logList"></ul></div></div></div>
            </div>
        </div>

        <div class="tab-pane fade" id="threats">
            
            <div class="card border-warning">
                <div class="card-header text-warning bg-dark"><i class="bi bi-activity"></i> 1. Network & Active Miners (Process)</div>
                <div class="card-body">
                    <button class="btn btn-warning btn-sm mb-2" onclick="scanNetwork()">‡∏™‡πÅ‡∏Å‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡∏∞ Process ‡∏Ç‡∏∏‡∏î</button>
                    <div class="table-responsive">
                        <table class="table table-dark table-sm table-hover">
                            <thead><tr><th>PID</th><th>Process</th><th>Remote IP</th><th>Risk</th><th>Action</th></tr></thead>
                            <tbody id="netThreatBody"><tr><td colspan="5" class="text-muted">‡∏£‡∏≠‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡πÅ‡∏Å‡∏ô...</td></tr></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="card border-info mt-3">
                <div class="card-header text-info bg-dark"><i class="bi bi-hdd-network"></i> 2. Deep Miner Hunt (Files & Services)</div>
                <div class="card-body">
                    <p class="small text-muted">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå Binary, Config ‡∏Ç‡∏∏‡∏î‡∏ö‡∏¥‡∏ó‡∏Ñ‡∏≠‡∏¢‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡πÅ‡∏•‡∏∞ Systemd Service ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏á‡∏™‡∏±‡∏¢</p>
                    <button class="btn btn-info btn-sm mb-2" onclick="scanMiners()">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ Miner ‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà</button>
                    <div id="minerResult"></div>
                </div>
            </div>

            <div class="card border-danger mt-3">
                <div class="card-header text-danger bg-dark"><i class="bi bi-bug"></i> 3. Smart Web Shell Scanner</div>
                <div class="card-body">
                    <div class="input-group mb-2">
                        <input type="text" class="form-control bg-dark text-light border-secondary" id="malwarePath" value="/home">
                        <button class="btn btn-danger" onclick="scanMalware()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πÅ‡∏Å‡∏ô</button>
                    </div>
                    <div id="malwareResult"></div>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="tools">
            <div class="row">
                <div class="col-md-6"><div class="card"><div class="card-header">Nmap Port Scanner</div><div class="card-body"><input type="text" class="form-control mb-2" id="nmapTarget" placeholder="IP Address"><button class="btn btn-primary btn-sm" onclick="runNmap()">Scan (1-1000)</button><pre id="nmapOut" class="mt-2 text-white">Result...</pre></div></div></div>
                <div class="col-md-6"><div class="card"><div class="card-header">Maintenance</div><div class="card-body"><h6>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Service:</h6><div class="input-group mb-3"><input type="text" class="form-control" id="srvName" placeholder="Service Name"><button class="btn btn-success" onclick="srvAction('start')">Start</button><button class="btn btn-danger" onclick="srvAction('stop')">Stop</button></div><button class="btn btn-outline-warning w-100" onclick="clearTemp()">üßπ ‡∏•‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏¢‡∏∞ /tmp (‡∏Å‡∏≥‡∏à‡∏±‡∏î Miner ‡πÅ‡∏ù‡∏á)</button><pre id="srvOut" class="mt-2 text-white"></pre></div></div></div>
            </div>
            <div class="card"><div class="card-header">‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (24 ‡∏ä‡∏°.)</div><div class="card-body"><button class="btn btn-secondary btn-sm" onclick="scanFiles()">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå</button><pre id="filesOut" class="mt-2 text-white"></pre></div></div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    const API = `http://${location.hostname}:8989/api`;
    const AUTH = { headers: { 'Authorization': 'Basic ' + btoa('root:BossHubRoot'), 'Content-Type': 'application/json' } };
    async function get(ep) { const r = await fetch(API+ep, AUTH); return r.json(); }
    async function post(ep, d) { const r = await fetch(API+ep, { ...AUTH, method: 'POST', body: JSON.stringify(d)}); return r.json(); }

    async function refreshDashboard() {
        const sys = await get('/stats');
        document.getElementById('cpuVal').innerText = sys.cpu.percent + '%';
        document.getElementById('ramVal').innerText = sys.ram.percent + '%';
        document.getElementById('uptimeVal').innerText = sys.uptime;
        document.getElementById('osVal').innerText = sys.os.split(' ')[0];
        let dHtml = ''; sys.disk.forEach(d => dHtml += `<div class="d-flex justify-content-between"><span>${d.mount}</span><span class="text-success">${d.percent}%</span></div>`);
        dHtml += '<hr class="border-secondary">'; for(let k in sys.network) dHtml += `<small class="d-block text-info">${k}: ${sys.network[k]}</small>`;
        document.getElementById('diskNetBody').innerHTML = dHtml;
        const sec = await get('/security_basic');
        document.getElementById('firewallOut').innerText = sec.firewall;
        document.getElementById('logList').innerHTML = sec.logs.map(l => `<li class="list-group-item bg-dark text-light border-secondary py-1">${l}</li>`).join('');
    }

    async function scanNetwork() {
        const t = document.getElementById('netThreatBody'); t.innerHTML = '<tr><td colspan="5">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πÅ‡∏Å‡∏ô...</td></tr>';
        const res = await get('/threats/network');
        if(res.length === 0) return t.innerHTML = '<tr><td colspan="5" class="text-success">‡πÑ‡∏°‡πà‡∏û‡∏ö Process ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢</td></tr>';
        t.innerHTML = '';
        res.forEach(r => {
            const btn = `<button class="btn btn-danger btn-sm" onclick="killProc(${r.pid})">KILL</button>`;
            t.innerHTML += `<tr><td>${r.pid}</td><td>${r.name}</td><td>${r.raddr}</td><td class="text-warning">${r.risk}</td><td>${btn}</td></tr>`;
        });
    }

    async function scanMiners() {
        const div = document.getElementById('minerResult'); div.innerHTML = '<div class="spinner-border text-info spinner-border-sm"></div> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå Miner...';
        const res = await get('/threats/miners');
        if(res.length === 0) return div.innerHTML = '<div class="alert alert-success mt-2">‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏£‡∏∑‡∏≠ Service ‡∏Ç‡∏≠‡∏á Miner</div>';
        let h = '';
        res.forEach(r => {
            h += `<div class="alert alert-dark border-info mt-2"><strong>${r.type}:</strong> ${r.path}<br><small class="text-info">${r.detail}</small></div>`;
        });
        div.innerHTML = h;
    }

    async function scanMalware() {
        const div = document.getElementById('malwareResult'); div.innerHTML = '<div class="spinner-border text-danger spinner-border-sm"></div> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πÅ‡∏Å‡∏ô...';
        const res = await get('/threats/malware?path=' + document.getElementById('malwarePath').value);
        let h = `<p class="mt-2 text-muted">‡∏™‡πÅ‡∏Å‡∏ô: ${res.scanned} | ‡πÄ‡∏à‡∏≠: <span class="badge bg-danger">${res.infected.length}</span></p>`;
        res.infected.forEach(f => {
            const isQ = f.status === 'quarantined';
            const btn = isQ ? `<button class="btn btn-success btn-sm ms-2" onclick="manageFile('${f.path}','restore')">Restore</button>` 
                            : `<button class="btn btn-warning btn-sm ms-2" onclick="manageFile('${f.path}','fix')">Block/Fix</button>`;
            const snippetHtml = (!isQ && f.snippet && f.snippet !== 'N/A') ? `<span class="code-snippet">${f.snippet}</span>` : '';
            h += `<div class="alert alert-dark border-${isQ?'success':'danger'} py-2"><div class="d-flex justify-content-between align-items-center"><div><strong class="${isQ?'text-success':'text-danger'}">${f.path}</strong><br><small class="text-white">${f.threats.join(', ')}</small></div>${btn}</div>${snippetHtml}</div>`;
        });
        div.innerHTML = h || '<div class="alert alert-success mt-2">‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢</div>';
    }

    async function killProc(pid) { if(confirm(`‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Kill Process ${pid}?`)) { const res = await post('/threats/kill_process', {pid}); alert(res.message); scanNetwork(); } }
    async function clearTemp() { if(confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô /tmp ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?')) { const res = await post('/tools/clear_temp', {}); alert(res.message); } }
    async function manageFile(p, a) { if(confirm(a==='fix'?'‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ?':'‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ?')) { const res = await post('/threats/manage_file', {path:p, action:a}); alert(res.message); scanMalware(); } }
    async function runNmap() { document.getElementById('nmapOut').innerText = 'Scanning...'; const res = await post('/tools/nmap', {target: document.getElementById('nmapTarget').value}); let txt = `Status: ${res.status}\n`; res.ports.forEach(p => txt += `Port ${p.port}: ${p.state} (${p.service})\n`); document.getElementById('nmapOut').innerText = txt; }
    async function srvAction(act) { document.getElementById('srvOut').innerText = 'Executing...'; const res = await post('/tools/service', {service: document.getElementById('srvName').value, action: act}); document.getElementById('srvOut').innerText = res.output || res.error || 'Done'; }
    async function scanFiles() { document.getElementById('filesOut').innerText = 'Finding...'; const res = await post('/tools/files', {days: 1}); document.getElementById('filesOut').innerText = res.files.join('\n') || 'No recent files'; }

    refreshDashboard(); setInterval(refreshDashboard, 30000);
</script>
</body>
</html>
